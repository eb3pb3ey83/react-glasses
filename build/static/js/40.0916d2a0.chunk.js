(this["webpackJsonpbtox-new"]=this["webpackJsonpbtox-new"]||[]).push([[40],{601:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(598),i=n(464),c=n(400),l=n(384),s=n(36),d=n(50);function u(e){return Object(d.a)({config:{url:"account/role",method:"get",params:e},name:s.a.role})}var b,m=n(594),j=n(460),h=n(3),O=function(e){var t=e.sortMethod;return Object(h.jsx)(m.a,{children:Object(h.jsxs)(c.a.HeadRow,{children:[Object(h.jsx)(c.a.HeadCell,{width:"33%",children:Object(h.jsx)(j.a,{sortMethod:t,sortDown:"-role_name_ch",sortUp:"role_name_ch",children:"\u89d2\u8272\u540d\u7a31"})}),Object(h.jsx)(c.a.HeadCell,{width:"33%",children:Object(h.jsx)(j.a,{sortMethod:t,sortDown:"-role_type",sortUp:"role_type",children:"\u5730\u5340"})}),Object(h.jsx)(c.a.HeadCell,{width:"34%",children:Object(h.jsx)(j.a,{sortMethod:t,sortDown:"-created_time",sortUp:"created_time",children:"\u5275\u5efa\u65e5\u671f"})})]})})},f=n(595),p=n(74),v=n(578),g=Object(v.a)((function(){return{container:{position:"relative",minHeight:"60px"}}})),x=Object(h.jsx)("tr",{children:Object(h.jsx)("td",{children:Object(h.jsx)(p.a,{})})}),_=Object(h.jsx)("tr",{children:Object(h.jsx)("td",{children:"\u62b1\u6b49, \u7a7a\u72c0\u614b\u9084\u6c92\u505a"})}),C=function(e){var t=e.list,n=e.isFetched,o=e.openEditor,a=g(),r="zh-TW"===window.localStorage.getItem("language");return Object(h.jsx)(f.a,{className:a.container,children:n?t.length>0?t.map((function(e){var t=e.id,n=e.role_name_ch,a=e.role_name_en,i=e.role_type,l=e.created_time;return Object(h.jsxs)(c.a.ContentRow,{children:[Object(h.jsx)(c.a.BodyCell,{onClick:function(){return o(t)},scope:"row",width:"33%",children:r?n:a}),Object(h.jsx)(c.a.BodyCell,{onClick:function(){return o(t)},scope:"row",width:"33%",children:i}),Object(h.jsx)(c.a.BodyCell,{onClick:function(){return o(t)},scope:"row",width:"34%",children:l.slice(0,10)})]},t)})):_:x})},E=n(361),y=n(620),w=n(416),S=n(461),R=function(e){var t=e.searchKeyword,n=e.searchRoleType,o=window.localStorage.getItem("roleKeywords"),a=[];o&&(a=JSON.parse(o));return Object(h.jsxs)(E.a,{display:"flex",justifyContent:"space-between",children:[Object(h.jsx)(S.a,{placeholder:"\u641c\u5c0b\u89d2\u8272\u59d3\u540d",onSubmit:function(e){t(e)},options:a}),Object(h.jsxs)(w.a,{defaultValue:0,width:140,placeholder:"\u9078\u64c7\u5730\u5340",onChange:function(e){n(e.target.value)},children:[Object(h.jsx)(y.a,{value:0,children:"\u5168\u90e8"}),Object(h.jsx)(y.a,{value:1,children:"\u570b\u5167"}),Object(h.jsx)(y.a,{value:2,children:"\u570b\u5916"})]})]})},A=n(580),N=n(458),P=n(387),I=n(39),k=function(e){var t=e.openDrawer,n=I.a.getPermissions("role:add");return Object(h.jsxs)(E.a,{display:"flex",justifyContent:"space-between",marginBottom:"20px",color:"#153C7B",children:[Object(h.jsx)(A.a,{variant:"h3",children:"\u89d2\u8272\u5217\u8868"}),n&&Object(h.jsx)(P.a,{width:85,height:40,onClick:t,fullWidth:!1,type:"button",startIcon:Object(h.jsx)("img",{src:N.a,alt:""}),children:"\u65b0\u589e"})]})},T=n(9),D=n(37),B=n(605),L=n(7),M=n(25),F=n(614);!function(e){e.OPEN_CREATOR="OPEN_CREATOR",e.OPEN_EDITOR="OPEN_EDITOR",e.CLOSE_DRAWER="CLOSE_DRAWER",e.PAGE_CHANGE="PAGE_CHANGE",e.ORDER_CHANGE="ORDER_CHANGE",e.KEYWORD_CHANGE="KEYWORD_CHANGE",e.ROLE_CHANGE="ROLE_CHANGE",e.OPEN_TOAST="OPEN_TOAST",e.CLOSE_TOAST="CLOSE_TOAST"}(b||(b={}));var G,W=n(409),z={changePage:Object(W.b)({currentPage:function(e,t){return t.page}}),changeKeyword:Object(W.b)({keyword:function(e,t){return t.keyword}}),changeOrder:Object(W.b)({order_by:function(e,t){return t.order_by}}),changeRole:Object(W.b)({role_type:function(e,t){return t.role_type}}),openCreator:function(e,t){t.history.push("/pages/usermanagement/role/create")},openEditor:function(e,t){t.id&&t.history.push("/pages/usermanagement/role/edit/".concat(t.id))},closeDrawer:function(e,t){t.history.push("/pages/usermanagement/role")},openToast:Object(W.b)({toastMessage:function(e,t){return t.message}})},H=Object(F.a)({context:{currentPage:1,page_size:10,keyword:"",order_by:"-role_name_ch",role_type:0,toastMessage:""},initial:"viewMode",states:{viewMode:{on:(G={},Object(M.a)(G,b.OPEN_CREATOR,{target:"creatorOpened",actions:z.openCreator}),Object(M.a)(G,b.OPEN_EDITOR,{target:"editorOpened",actions:z.openEditor}),Object(M.a)(G,b.PAGE_CHANGE,{actions:z.changePage}),Object(M.a)(G,b.KEYWORD_CHANGE,{actions:z.changeKeyword}),Object(M.a)(G,b.ORDER_CHANGE,{actions:z.changeOrder}),Object(M.a)(G,b.ROLE_CHANGE,{actions:z.changeRole}),Object(M.a)(G,b.OPEN_TOAST,{target:"toastOpened",actions:z.openToast}),G)},creatorOpened:{on:Object(M.a)({},b.CLOSE_DRAWER,{target:"viewMode",actions:z.closeDrawer})},editorOpened:{on:Object(M.a)({},b.CLOSE_DRAWER,{target:"viewMode",actions:z.closeDrawer})},toastOpened:{on:Object(M.a)({},b.CLOSE_TOAST,"viewMode")}}}),U=n(465),K=function(e){var t=e.totalPage,n=e.currentPage,o=e.changePage;return Object(h.jsx)(U.a,{shape:"rounded",count:t,page:n,onChange:function(e,t){o(t)}})},V=n(105),q=n(414),$=n(581),Y=n(1),Q=n(109),J=n(6),X=(n(10),n(28)),Z=n(35),ee=o.forwardRef((function(e,t){var n=e.classes,a=e.className,r=e.row,i=void 0!==r&&r,c=Object(J.a)(e,["classes","className","row"]);return o.createElement("div",Object(Y.a)({className:Object(X.a)(n.root,a,i&&n.row),ref:t},c))})),te=Object(Z.a)({root:{display:"flex",flexDirection:"column",flexWrap:"wrap"},row:{flexDirection:"row"}},{name:"MuiFormGroup"})(ee),ne=n(106),oe=n(115);var ae=o.createContext(),re=n(123),ie=o.forwardRef((function(e,t){var n=e.actions,a=e.children,r=e.name,i=e.value,c=e.onChange,l=Object(J.a)(e,["actions","children","name","value","onChange"]),s=o.useRef(null),d=Object(oe.a)({controlled:i,default:e.defaultValue,name:"RadioGroup"}),u=Object(Q.a)(d,2),b=u[0],m=u[1];o.useImperativeHandle(n,(function(){return{focus:function(){var e=s.current.querySelector("input:not(:disabled):checked");e||(e=s.current.querySelector("input:not(:disabled)")),e&&e.focus()}}}),[]);var j=Object(ne.a)(t,s),h=Object(re.a)(r);return o.createElement(ae.Provider,{value:{name:h,onChange:function(e){m(e.target.value),c&&c(e,e.target.value)},value:b}},o.createElement(te,Object(Y.a)({role:"radiogroup",ref:j},l),a))})),ce=n(597),le=n(434),se=n(108),de=Object(se.a)(o.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),ue=Object(se.a)(o.createElement("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked");var be=Object(Z.a)((function(e){return{root:{position:"relative",display:"flex","&$checked $layer":{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}},layer:{left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest})},checked:{}}}),{name:"PrivateRadioButtonIcon"})((function(e){var t=e.checked,n=e.classes,a=e.fontSize;return o.createElement("div",{className:Object(X.a)(n.root,t&&n.checked)},o.createElement(de,{fontSize:a}),o.createElement(ue,{fontSize:a,className:n.layer}))})),me=n(51),je=n(32),he=n(110);var Oe=o.createElement(be,{checked:!0}),fe=o.createElement(be,null),pe=o.forwardRef((function(e,t){var n=e.checked,a=e.classes,r=e.color,i=void 0===r?"secondary":r,c=e.name,l=e.onChange,s=e.size,d=void 0===s?"medium":s,u=Object(J.a)(e,["checked","classes","color","name","onChange","size"]),b=o.useContext(ae),m=n,j=Object(he.a)(l,b&&b.onChange),h=c;return b&&("undefined"===typeof m&&(m=b.value===e.value),"undefined"===typeof h&&(h=b.name)),o.createElement(le.a,Object(Y.a)({color:i,type:"radio",icon:o.cloneElement(fe,{fontSize:"small"===d?"small":"default"}),checkedIcon:o.cloneElement(Oe,{fontSize:"small"===d?"small":"default"}),classes:{root:Object(X.a)(a.root,a["color".concat(Object(je.a)(i))]),checked:a.checked,disabled:a.disabled},name:h,checked:m,onChange:j,ref:t},u))})),ve=Object(Z.a)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(me.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(me.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiRadio"})(pe),ge=n(386),xe=n(401),_e=n(393),Ce=Object(v.a)((function(e){return{container:function(e){var t=e.isError;return{border:"1px solid ".concat(t?"#ff1744":"#BED1F6"),borderRadius:"8px","&:not(:last-child)":{marginBottom:"16px"}}},titleContainer:{borderBottom:"2px solid #F4F7FD",padding:"17px 32px"},flag:{position:"static",width:"4px",height:"16px",left:0,top:"1px",background:"#BED1F6",borderRadius:"2px",flex:"none",order:0,flexGrow:0,margin:"0px 8px"},title:{color:e.palette.primary.main,position:"relative",display:"flex",alignItems:"center",fontWeight:500,transform:"translateX(-7px)"}}})),Ee=function(e){var t=e.children,n=e.title,o=e.isError,a=Ce({isError:o});return Object(h.jsxs)(E.a,{className:a.container,children:[Object(h.jsx)(E.a,{className:a.titleContainer,children:Object(h.jsxs)(A.a,{className:a.title,variant:"subtitle1",children:[Object(h.jsx)("span",{className:a.flag}),n]})}),Object(h.jsx)(E.a,{children:t})]})},ye=a.a.createContext(null),we=n(611),Se=Object(v.a)((function(){return{container:{padding:"15px 32px","&:nth-child(even)":{background:"rgba(244, 247, 253, 0.5)"}},title:{color:"#57729E",paddingRight:"24px",transform:"translateY(-1px)"}}})),Re=function(e){var t=e.title,n=e.children,o=e.handleSelectAll,a=e.isSelectAll,r=e.isIndeterminate,i=e.disabled,c=Se();return Object(h.jsxs)(E.a,{className:c.container,children:[Object(h.jsxs)(E.a,{display:"flex",alignItems:"center",marginBottom:"3px",children:[t&&Object(h.jsx)(A.a,{className:c.title,variant:"h6",children:t}),Object(h.jsx)(ce.a,{control:Object(h.jsx)(we.a,{disabled:i,indeterminate:r,checked:a,onChange:o,name:"gilad"}),label:"\u5168\u9078"})]}),Object(h.jsx)(E.a,{children:n})]})},Ae=function(e){var t=e.menuButtons,n=window.localStorage.getItem("language"),o=a.a.useContext(ye);return Object(h.jsx)(h.Fragment,{children:t.map((function(e){var t=Boolean(null===o||void 0===o?void 0:o.selectedList.find((function(t){return e.id===t})));return Object(h.jsx)(ge.a,{name:"menus_buttons_id",render:function(a){return Object(h.jsx)(ce.a,{onChange:function(){return a.onChange(null===o||void 0===o?void 0:o.handleCheck(e.id))},control:Object(h.jsx)(we.a,{checked:t}),label:n?e.button_name_ch:e.button_name_en})},control:null===o||void 0===o?void 0:o.control},e.id)}))})},Ne=function(e){var t=e.menuItem,n=window.localStorage.getItem("language"),o=a.a.useContext(ye);return Object(h.jsx)(Re,{isSelectAll:null===o||void 0===o?void 0:o.checkIsSelectAll(t.buttons),isIndeterminate:null===o||void 0===o?void 0:o.checkIsIndeterminate(t.buttons),handleSelectAll:function(){return null===o||void 0===o?void 0:o.handleSelectAll(t.buttons)},title:n?t.menu_name_ch:t.menu_name_en,children:Object(h.jsx)(Ae,{menuButtons:t.buttons})})},Pe=Object(v.a)((function(e){return{roleName:{display:"grid",gridTemplateColumns:"1fr 1fr",gridColumnGap:"16px",marginBottom:"20px"},settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"},errorMessage:{display:"inline-flex",alignItems:"center",color:"#ff1744",marginLeft:"10px",fontSize:e.variables.fontSizeXs,"& .MuiSvgIcon-root":{color:"#ff1744"}},radioGroup:{flexDirection:"row",marginBottom:"12px"}}})),Ie=function(e){var t,n,o,r,i=e.menuButtons,c=Pe(),l=window.localStorage.getItem("language"),s=a.a.useContext(ye);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(E.a,{className:c.roleName,children:[Object(h.jsx)(_e.a,{name:"role_name_ch",ref:null===s||void 0===s?void 0:s.register,placeholder:"\u8acb\u8f38\u5165\u4e2d\u6587\u89d2\u8272\u540d\u7a31",height:40,label:"\u89d2\u8272\u540d\u7a31",labelClassName:c.label,error:Boolean(null===s||void 0===s?void 0:s.errors.role_name_ch),errorMessage:null===s||void 0===s||null===(t=s.errors)||void 0===t||null===(n=t.role_name_ch)||void 0===n?void 0:n.message}),Object(h.jsx)(_e.a,{name:"role_name_en",ref:null===s||void 0===s?void 0:s.register,placeholder:"\u8acb\u8f38\u5165\u82f1\u6587\u89d2\u8272\u540d\u7a31",height:40,error:Boolean(null===s||void 0===s?void 0:s.errors.role_name_en),errorMessage:null===s||void 0===s||null===(o=s.errors)||void 0===o||null===(r=o.role_name_en)||void 0===r?void 0:r.message})]}),Object(h.jsx)($.a,{className:"".concat(c.label),children:"\u985e\u5225"}),Object(h.jsx)(ge.a,{name:"role_type",render:function(e){return Object(h.jsxs)(ie,{value:e.value,onChange:function(t){return e.onChange(Number(t.target.value))},"aria-label":"gender",className:c.radioGroup,children:[Object(h.jsx)(ce.a,{value:0,control:Object(h.jsx)(ve,{}),label:"\u5168\u90e8"}),Object(h.jsx)(ce.a,{value:1,control:Object(h.jsx)(ve,{}),label:"\u570b\u5167"}),Object(h.jsx)(ce.a,{value:2,control:Object(h.jsx)(ve,{}),label:"\u570b\u5916"})]})},control:null===s||void 0===s?void 0:s.control}),Object(h.jsxs)($.a,{className:"".concat(c.label," ").concat(c.settingLabel),children:["\u6b0a\u9650\u8a2d\u5b9a",(null===s||void 0===s?void 0:s.errors.menus_buttons_id)&&Object(h.jsx)(xe.a,{className:c.errorMessage,message:"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u529f\u80fd"})]}),i.map((function(e){return Object(h.jsx)(Ee,{isError:Boolean(null===s||void 0===s?void 0:s.errors.menus_buttons_id),title:l?e.menu_name_ch:e.menu_name_en,children:Object(h.jsx)(te,{children:e.sub_menu?e.sub_menu.map((function(e){return Object(h.jsx)(Ne,{menuItem:e},e.id)})):Object(h.jsx)(Ne,{menuItem:e})})},e.id)}))]})};function ke(){return Object(d.a)({config:{url:"menus/menus_buttons",method:"get"},name:s.a.menuButton})}function Te(){var e=Object(l.a)([s.a.menuButton],ke,{keepPreviousData:!0});return{data:e.data,isMenuInfoFetched:e.isFetched}}var De=n(388),Be=n(390),Le=n(394),Me=n(55),Fe=(n(391),function(e,t){var n=Be.e().required("\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d").test("checkNameUnique","\u89d2\u8272\u540d\u7a31\u5df2\u91cd\u8907",(function(e){return u({keyword:e}).then((function(e){return 0===e.data.result_data.length}))})),o=Be.d().shape({role_name_ch:n,role_name_en:n,menus_buttons_id:Be.a().transform((function(e){return e.filter((function(e){return 0===e||e}))})).min(1,"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u529f\u80fd")}),a=Object(ge.c)({resolver:Object(Le.a)(o),defaultValues:{role_type:0,role_name_en:"",role_name_ch:"",menus_buttons_id:[]}}),r=a.control,i=a.handleSubmit,c=a.getValues,l=a.setValue,s=a.watch,d=a.errors,b=a.register,m=d,j=s("menus_buttons_id");return{control:r,handleSubmit:i,handleSelectAll:function(e){var t=e.map((function(e){return e.id})),n=Object(Me.intersection)(t,j).length===t.length;l("menus_buttons_id",n?Object(Me.xor)(j,t):[].concat(Object(De.a)(null!==j&&void 0!==j?j:[]),Object(De.a)(t)))},checkIsSelectAll:function(e){var t,n=null===e||void 0===e?void 0:e.map((function(e){return e.id}));return(null===(t=Object(Me.intersection)(n,j))||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length)},checkIsIndeterminate:function(e){var t=null===e||void 0===e?void 0:e.map((function(e){return e.id})),n=Object(Me.intersection)(t,j);return!((null===n||void 0===n?void 0:n.length)===(null===t||void 0===t?void 0:t.length))&&n.length>0},handleCheck:function(e){var t=c().menus_buttons_id;return Boolean(t.find((function(t){return t===e})))?function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e!==t}))}(t,e):[].concat(Object(De.a)(null!==t&&void 0!==t?t:[]),[e])},hasSelectItem:!Object(Me.isEmpty)(j),selectedList:j,setValue:l,onSubmit:function(n){e(n),t()},errors:m,register:b}}),Ge=n(177),We=n(616);function ze(e){return Object(d.a)({config:{url:"account/role",method:"post",data:e},name:s.a.crateRole})}var He=Object(v.a)((function(){return{saveButton:{marginLeft:"15px"},deleteButton:{borderColor:"#F66363",color:"#F66363"}}})),Ue=function(e){var t=e.closeDrawer,n=e.openToast,o=Te(),a=o.data,r=o.isMenuInfoFetched,i=function(e){var t=Object(Ge.b)();return Object(We.a)(ze,{onSuccess:function(){e("\u5df2\u6210\u529f\u65b0\u589e\u4e00\u7b46\u89d2\u8272"),t.invalidateQueries(s.a.role)}})}(n).mutate,c=He(),l=Fe(i,t),d=l.handleSubmit,u=l.onSubmit,b=Object(V.a)(l,["handleSubmit","onSubmit"]);return Object(h.jsx)(ye.Provider,{value:b,children:Object(h.jsx)(q.a.Container,{title:"\u5efa\u7acb\u89d2\u8272",open:!0,onClose:t,children:Object(h.jsxs)("form",{onSubmit:d(u),children:[Object(h.jsx)(q.a.Content,{children:r&&a&&Object(h.jsx)(Ie,{menuButtons:a.data.result_data})}),Object(h.jsx)(q.a.Footer,{children:Object(h.jsx)(E.a,{display:"flex",justifyContent:"flex-end",children:Object(h.jsxs)(E.a,{children:[Object(h.jsx)(P.a,{width:113,height:40,isWhiteButton:!0,fullWidth:!1,type:"button",children:"\u53d6\u6d88"}),Object(h.jsx)(P.a,{className:c.saveButton,width:113,height:40,fullWidth:!1,type:"submit",children:"\u5132\u5b58"})]})})})]})})})},Ke=n.p+"static/media/delete.11a6f838.svg",Ve=a.a.createContext(null),qe=function(e){var t=e.menuButtons,n=window.localStorage.getItem("language"),o=a.a.useContext(Ve);return Object(h.jsx)(h.Fragment,{children:t.map((function(e){var t=Boolean(null===o||void 0===o?void 0:o.selectedList.find((function(t){return e.id===t})));return Object(h.jsx)(ge.a,{name:"menus_buttons_id",render:function(a){return Object(h.jsx)(ce.a,{onChange:function(){return a.onChange(null===o||void 0===o?void 0:o.handleCheck(e.id))},control:Object(h.jsx)(we.a,{disabled:!(null===o||void 0===o?void 0:o.hasUpdatePermission),checked:t}),label:n?e.button_name_ch:e.button_name_en})},control:null===o||void 0===o?void 0:o.control},e.id)}))})},$e=function(e){var t=e.menuItem,n=window.localStorage.getItem("language"),o=a.a.useContext(Ve);return Object(h.jsx)(Re,{disabled:!(null===o||void 0===o?void 0:o.hasUpdatePermission),isSelectAll:null===o||void 0===o?void 0:o.checkIsSelectAll(t.buttons),isIndeterminate:null===o||void 0===o?void 0:o.checkIsIndeterminate(t.buttons),handleSelectAll:function(){return null===o||void 0===o?void 0:o.handleSelectAll(t.buttons)},title:n?t.menu_name_ch:t.menu_name_en,children:Object(h.jsx)(qe,{menuButtons:t.buttons})})},Ye=Object(v.a)((function(e){return{roleName:{display:"grid",gridTemplateColumns:"1fr 1fr",gridColumnGap:"16px",marginBottom:"20px"},settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"},errorMessage:{display:"inline-flex",alignItems:"center",color:"#ff1744",marginLeft:"10px",fontSize:e.variables.fontSizeXs,"& .MuiSvgIcon-root":{color:"#ff1744"}},radioGroup:{flexDirection:"row",marginBottom:"12px"}}})),Qe=function(e){var t,n,o,r,i=e.menuButtons,c=Ye(),l=window.localStorage.getItem("language"),s=a.a.useContext(Ve);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(E.a,{className:c.roleName,children:[Object(h.jsx)(_e.a,{name:"role_name_ch",ref:null===s||void 0===s?void 0:s.register,disabled:!(null===s||void 0===s?void 0:s.hasUpdatePermission),placeholder:"\u8acb\u8f38\u5165\u4e2d\u6587\u89d2\u8272\u540d\u7a31",height:40,label:"\u89d2\u8272\u540d\u7a31",labelClassName:c.label,error:Boolean(null===s||void 0===s?void 0:s.errors.role_name_ch),errorMessage:null===s||void 0===s||null===(t=s.errors)||void 0===t||null===(n=t.role_name_ch)||void 0===n?void 0:n.message}),Object(h.jsx)(_e.a,{name:"role_name_en",ref:null===s||void 0===s?void 0:s.register,disabled:!(null===s||void 0===s?void 0:s.hasUpdatePermission),placeholder:"\u8acb\u8f38\u5165\u82f1\u6587\u89d2\u8272\u540d\u7a31",height:40,error:Boolean(null===s||void 0===s?void 0:s.errors.role_name_en),errorMessage:null===s||void 0===s||null===(o=s.errors)||void 0===o||null===(r=o.role_name_en)||void 0===r?void 0:r.message})]}),Object(h.jsx)($.a,{className:"".concat(c.label),children:"\u985e\u5225"}),Object(h.jsx)(ge.a,{name:"role_type",render:function(e){return Object(h.jsxs)(ie,{value:e.value,onChange:function(t){return e.onChange(Number(t.target.value))},"aria-label":"gender",className:c.radioGroup,children:[Object(h.jsx)(ce.a,{disabled:!(null===s||void 0===s?void 0:s.hasUpdatePermission),value:0,control:Object(h.jsx)(ve,{}),label:"\u5168\u90e8"}),Object(h.jsx)(ce.a,{disabled:!(null===s||void 0===s?void 0:s.hasUpdatePermission),value:1,control:Object(h.jsx)(ve,{}),label:"\u570b\u5167"}),Object(h.jsx)(ce.a,{disabled:!(null===s||void 0===s?void 0:s.hasUpdatePermission),value:2,control:Object(h.jsx)(ve,{}),label:"\u570b\u5916"})]})},control:null===s||void 0===s?void 0:s.control}),Object(h.jsxs)($.a,{className:"".concat(c.label," ").concat(c.settingLabel),children:["\u6b0a\u9650\u8a2d\u5b9a",(null===s||void 0===s?void 0:s.errors.menus_buttons_id)&&Object(h.jsx)(xe.a,{className:c.errorMessage,message:"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u529f\u80fd"})]}),i.map((function(e){return Object(h.jsx)(Ee,{isError:Boolean(null===s||void 0===s?void 0:s.errors.menus_buttons_id),title:l?e.menu_name_ch:e.menu_name_en,children:Object(h.jsx)(te,{children:e.sub_menu?e.sub_menu.map((function(e){return Object(h.jsx)($e,{menuItem:e},e.id)})):Object(h.jsx)($e,{menuItem:e})})},e.id)}))]})},Je=function(e,t,n,o,r){var i=Be.d().shape({role_name_ch:Be.e().required("\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d"),role_name_en:Be.e().required("\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d"),menus_buttons_id:Be.a().transform((function(e){return e.filter((function(e){return 0===e||e}))})).min(1,"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u529f\u80fd")}),c=Object(ge.c)({resolver:Object(Le.a)(i),defaultValues:{role_type:0,role_name_en:"",role_name_ch:"",menus_buttons_id:[]}}),l=c.control,s=c.handleSubmit,d=c.getValues,u=c.setValue,b=c.watch,m=c.errors,j=c.register,h=m,O=b("menus_buttons_id"),f=!Object(Me.isEmpty)(O);return a.a.useLayoutEffect((function(){if(o&&r){var e=o.menus.flatMap((function(e){return e.menusbuttons})).filter((function(e){return"1"===e.open_flag})).map((function(e){return e.id}));u("role_type",Number(o.role_type)),u("role_name_en",o.role_name_en),u("role_name_ch",o.role_name_ch),u("menus_buttons_id",e)}}),[r,o,l]),{control:l,handleSubmit:s,handleSelectAll:function(e){var t=e.map((function(e){return e.id})),n=Object(Me.intersection)(t,O).length===t.length;u("menus_buttons_id",n?Object(Me.xor)(O,t):[].concat(Object(De.a)(null!==O&&void 0!==O?O:[]),Object(De.a)(t)))},checkIsSelectAll:function(e){var t,n=null===e||void 0===e?void 0:e.map((function(e){return e.id}));return(null===(t=Object(Me.intersection)(n,O))||void 0===t?void 0:t.length)===(null===n||void 0===n?void 0:n.length)},checkIsIndeterminate:function(e){var t=null===e||void 0===e?void 0:e.map((function(e){return e.id})),n=Object(Me.intersection)(t,O);return!((null===n||void 0===n?void 0:n.length)===(null===t||void 0===t?void 0:t.length))&&n.length>0},handleCheck:function(e){var t=d().menus_buttons_id;return Boolean(t.find((function(t){return t===e})))?function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e!==t}))}(t,e):[].concat(Object(De.a)(null!==t&&void 0!==t?t:[]),[e])},hasSelectItem:f,selectedList:O,setValue:u,onSubmit:function(o){e({updateData:o,id:n}),t()},errors:h,register:j}};function Xe(e){var t=Object(Ge.b)(),n=Object(l.a)([s.a.roleInfo,e],(function(){return t={id:e},Object(d.a)({config:{url:"".concat("account/role","/").concat(t.id),method:"get"},name:s.a.roleInfo});var t}),{refetchOnWindowFocus:!1,refetchOnMount:!1,retry:!1}),o=n.data,r=n.isFetched;return a.a.useEffect((function(){t.invalidateQueries(s.a.roleInfo)}),[e]),{roleInfo:null===o||void 0===o?void 0:o.data.result_data,isRoleInfoFetched:r}}var Ze;function et(e){return Object(d.a)({config:{url:"".concat("account/role","/").concat(e.id),method:"patch",data:e.updateData},name:s.a.updateRole})}!function(e){e.OPEN_ALERT="OPEN_ALERT",e.CLOSE_ALERT="CLOSE_ALERT"}(Ze||(Ze={}));var tt=Object(F.a)({context:{hasDeletePermission:!1,hasUpdatePermission:!1,hasAllPermission:!1},initial:"alertClosed",states:{alertClosed:{on:Object(M.a)({},Ze.OPEN_ALERT,"alertOpened")},alertOpened:{on:Object(M.a)({},Ze.CLOSE_ALERT,"alertClosed")}}}),nt=n(466);function ot(e){return Object(d.a)({config:{url:"".concat("account/role","/").concat(e.id),method:"delete"},name:s.a.deleteRole})}var at=Object(v.a)((function(){return{saveButton:{marginLeft:"15px"},deleteButton:{borderColor:"#F66363",color:"#F66363"}}})),rt=function(e){var t=e.closeDrawer,n=e.openToast,o=Object(L.i)(),a=Te(),r=a.data,i=a.isMenuInfoFetched,c=function(){var e=I.a.getPermissions("role:del"),t=I.a.getPermissions("role:up"),n=Object(B.b)(tt,{context:{hasDeletePermission:e,hasUpdatePermission:t,hasAllPermission:e&&t}}),o=Object(D.a)(n,2),a=o[0],r=o[1],i={openAlert:function(){r({type:Ze.OPEN_ALERT})},closeAlert:function(){r({type:Ze.CLOSE_ALERT})}};return Object(T.a)(Object(T.a)({},i),{},{isAlertOpen:a.matches("alertOpened"),hasDeletePermission:a.context.hasDeletePermission,hasUpdatePermission:a.context.hasUpdatePermission,hasAllPermission:a.context.hasAllPermission})}(),l=c.hasAllPermission,d=c.hasDeletePermission,u=c.hasUpdatePermission,b=c.openAlert,m=c.closeAlert,j=c.isAlertOpen,O=Xe(o.id),f=O.roleInfo,p=O.isRoleInfoFetched,v=function(e){var t=Object(Ge.b)();return Object(We.a)(et,{onSuccess:function(){e("\u5df2\u6210\u529f\u66f4\u65b0\u4e00\u7b46\u89d2\u8272"),t.invalidateQueries(s.a.role)}})}(n).mutate,g=at(),x=Je(v,t,Number(o.id),f,p),_=x.handleSubmit,C=x.onSubmit,y=Object(V.a)(x,["handleSubmit","onSubmit"]),w=function(e,t){var n=Object(Ge.b)();return Object(We.a)(ot,{onSuccess:function(){e(),t("\u5df2\u6210\u529f\u522a\u9664\u4e00\u7b46\u89d2\u8272"),n.invalidateQueries(s.a.role)}})}(t,n).mutate,S="zh-TW"===window.localStorage.getItem("language");return Object(h.jsx)(Ve.Provider,{value:Object(T.a)(Object(T.a)({},y),{},{hasUpdatePermission:u}),children:Object(h.jsxs)(q.a.Container,{title:"\u7de8\u8f2f\u89d2\u8272",open:!0,onClose:t,children:[Object(h.jsx)(nt.a,{onClose:m,open:j,onConfirm:function(){return w({id:o.id})},isDicidedMode:!0,title:"\u78ba\u5b9a\u522a\u9664\u89d2\u8272".concat(S?null===f||void 0===f?void 0:f.role_name_ch:null===f||void 0===f?void 0:f.role_name_en,"\uff1f"),content:"\u6b64\u89d2\u8272\u6240\u7d81\u5b9a\u4e4b\u6b0a\u9650\u5c07\u4e00\u4f75\u522a\u9664\uff0c\u4f60\u78ba\u5b9a\u8981\u522a\u9664\u89d2\u8272\u55ce\uff1f"}),Object(h.jsxs)("form",{onSubmit:_(C),children:[Object(h.jsx)(q.a.Content,{children:i&&p&&r&&Object(h.jsx)(Qe,{menuButtons:r.data.result_data})}),l&&Object(h.jsx)(q.a.Footer,{children:Object(h.jsxs)(E.a,{display:"flex",justifyContent:"space-between",children:[d&&Object(h.jsx)(P.a,{width:115,height:40,className:g.deleteButton,isDeleteButton:!0,startIcon:Object(h.jsx)("img",{src:Ke,alt:""}),fullWidth:!1,onClick:b,type:"button",children:"\u522a\u9664\u89d2\u8272"}),Object(h.jsxs)(E.a,{children:[Object(h.jsx)(P.a,{onClick:t,width:113,height:40,isWhiteButton:!0,fullWidth:!1,type:"button",children:"\u53d6\u6d88"}),Object(h.jsx)(P.a,{className:g.saveButton,width:113,height:40,fullWidth:!1,type:"submit",children:"\u5132\u5b58"})]})]})})]})]})})},it=function(e){var t=e.closeDrawer,n=e.openToast,a=I.a.getPermissions("role:add");return Object(h.jsx)(o.Suspense,{fallback:Object(h.jsx)(p.a,{}),children:Object(h.jsxs)(L.d,{children:[a&&Object(h.jsx)(L.b,{strict:!0,sensitive:!0,exact:!0,path:"/pages/usermanagement/role/create",children:Object(h.jsx)(Ue,{closeDrawer:t,openToast:n})}),Object(h.jsx)(L.b,{strict:!0,sensitive:!0,exact:!0,path:"/pages/usermanagement/role/edit/:id",children:Object(h.jsx)(rt,{closeDrawer:t,openToast:n})}),Object(h.jsx)(L.a,{exact:!0,from:"/pages/usermanagement/role/*",to:"/pages/usermanagement/role"})]})})},ct=n(463);t.default=function(){var e=function(){var e=Object(B.b)(H),t=Object(D.a)(e,2),n=t[0],o=t[1],r=Object(L.g)(),i=Object(L.h)(),c={openCreator:function(){o({type:b.OPEN_CREATOR,history:r})},closeToast:function(){o({type:b.CLOSE_TOAST})},closeDrawer:function(){o({type:b.CLOSE_DRAWER,history:r})},openEditor:function(e){o({type:b.OPEN_EDITOR,history:r,id:e})},searchKeyword:function(e){o({type:b.KEYWORD_CHANGE,keyword:e})},searchRoleType:function(e){o({type:b.ROLE_CHANGE,role_type:e})},changePage:function(e){o({type:b.PAGE_CHANGE,page:e})},changeOrder:function(e){o({type:b.ORDER_CHANGE,order_by:e})},openToast:function(e){o({type:b.OPEN_TOAST,message:e})}};return a.a.useEffect((function(){var e=i.pathname.includes("create"),t=i.pathname.includes("edit");e&&c.openCreator(),t&&c.openEditor()}),[i]),Object(T.a)(Object(T.a)({},c),{},{isToastOpen:n.matches("toastOpened"),context:n.context})}(),t=e.openCreator,n=e.openEditor,o=e.openToast,d=e.closeToast,m=e.isToastOpen,j=e.closeDrawer,f=e.changePage,p=e.changeOrder,v=e.searchKeyword,g=e.searchRoleType,x=e.context,_=function(e){var t=e.currentPage,n=e.keyword,o=e.order_by,a=e.role_type,r=e.page_size,i=Object(l.a)([s.a.role,t,n,o,a,r],(function(){return u({page:t,keyword:n,order_by:o,role_type:a,page_size:r})}),{keepPreviousData:!0});return{data:i.data,isFetched:i.isFetched}}(x),E=_.data,y=_.isFetched,w=null===E||void 0===E?void 0:E.data.result_data,S=null===E||void 0===E?void 0:E.data.pagination.total_pages;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(ct.a,{anchorOrigin:{horizontal:"center",vertical:"top"},open:m,onClose:d,message:x.toastMessage,severity:"success"}),Object(h.jsx)(k,{openDrawer:t}),Object(h.jsxs)(i.a.Container,{children:[Object(h.jsx)(i.a.Control,{children:Object(h.jsx)(R,{searchKeyword:v,searchRoleType:g})}),Object(h.jsx)(i.a.Info,{children:Object(h.jsx)(r.a,{children:Object(h.jsxs)(c.a.Table,{children:[Object(h.jsx)(O,{sortMethod:p}),Object(h.jsx)(C,{openEditor:n,isFetched:y,list:w})]})})})]}),Object(h.jsx)(K,{totalPage:S,currentPage:x.currentPage,changePage:f}),Object(h.jsx)(it,{closeDrawer:j,openToast:o})]})}}}]);
//# sourceMappingURL=40.0916d2a0.chunk.js.map