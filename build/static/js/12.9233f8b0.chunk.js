(this["webpackJsonpbtox-new"]=this["webpackJsonpbtox-new"]||[]).push([[12],{403:function(e,t,n){"use strict";var a=n(390);t.a=a.e().matches(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/,"\u4fe1\u7bb1\u683c\u5f0f\u4e0d\u6b63\u78ba").required("\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d")},600:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(598),i=n(464),c=n(400),l=n(384),s=n(36),d=n(50),u=n(37);function p(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=Object(u.a)(e,2)[1];return Boolean(t)})))}function m(e){var t=e.currentPage,n=Object(l.a)([s.a.role,t],(function(){return e={page:t},Object(d.a)({config:{url:"account/role",method:"get",params:p(e)},name:s.a.role});var e}),{keepPreviousData:!0});return{roleResponse:n.data,isRoleFetched:n.isFetched}}var b=n(594),h=n(460),j=n(3),f=function(e){var t=e.sortMethod;return Object(j.jsx)(b.a,{children:Object(j.jsxs)(c.a.HeadRow,{children:[Object(j.jsx)(c.a.HeadCell,{width:"11%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-user_name_ch",sortUp:"user_name_ch",children:"\u59d3\u540d"})}),Object(j.jsx)(c.a.HeadCell,{width:"28%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-email",sortUp:"email",children:"\u96fb\u5b50\u90f5\u4ef6\u5730\u5740"})}),Object(j.jsx)(c.a.HeadCell,{width:"28%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-created_time",sortUp:"created_time",children:"\u89d2\u8272"})}),Object(j.jsx)(c.a.HeadCell,{width:"11%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-dept_id",sortUp:"dept_id",children:"\u90e8\u9580"})}),Object(j.jsx)(c.a.HeadCell,{width:"11%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-open_flag",sortUp:"open_flag",children:"\u5e33\u865f\u72c0\u614b"})}),Object(j.jsx)(c.a.HeadCell,{width:"11%",children:Object(j.jsx)(h.a,{sortMethod:t,sortDown:"-created_time",sortUp:"created_time",children:"\u5275\u5efa\u65e5\u671f"})})]})})},O=n(25),g=n(9),x=n(595),v=n(74),_=n(179),C=n(578),E=Object(C.a)((function(e){return{label:{background:"#405F91",borderRadius:"6px",color:"#fff",padding:"3px 11px",marginRight:"10px",minHeight:"25px"},text:{display:"inline-block",paddingRight:"5px"},more:{fontSize:e.variables.fontSizeSm,color:"#6C83A9"}}})),S=function(e){var t=e.selectedList,n=e.hasDeleteIcon,a=e.onClick,r=e.limited,o=e.limitedLength,i=E(),c=t.slice(0,o),l=t.length-c.length,s=t.length>1;return r&&s&&o?Object(j.jsxs)(j.Fragment,{children:[c.map((function(e){return Object(j.jsxs)("button",{className:i.label,onClick:function(){return a&&a(e)},children:[Object(j.jsx)("span",{className:i.text,children:e.name}),a&&n&&Object(j.jsx)("img",{src:_.a,alt:""})]},e.id)})),Object(j.jsx)("span",{className:i.more,children:"+".concat(l)})]}):Object(j.jsx)(j.Fragment,{children:t.map((function(e){return Object(j.jsxs)("button",{className:i.label,onClick:function(){return a&&a(e)},children:[Object(j.jsx)("span",{className:i.text,children:e.name}),a&&n&&Object(j.jsx)("img",{src:_.a,alt:""})]},e.id)}))})};S.defaultProps={hasDeleteIcon:!0};var w=S,y=Object(C.a)((function(){return{container:{position:"relative",minHeight:"60px"}}})),L=Object(j.jsx)("tr",{children:Object(j.jsx)("td",{children:Object(j.jsx)(v.a,{})})}),D=function(e){var t=e.list,n=e.isFetched,a=e.openEditor,o=y(),i=r.a.useState({}),l=Object(u.a)(i,2),s=l[0],d=l[1],p="zh-TW"===window.localStorage.getItem("language");return Object(j.jsx)(x.a,{className:o.container,children:n?t.map((function(e){var r,o,i=e.id,l=e.user_name_ch,u=e.user_name_en,m=e.email,b=e.roles,h=e.dept_name_ch,f=e.dept_name_en,x=e.open_flag_name,v=e.created_time;return Object(j.jsxs)(c.a.ContentRow,{children:[Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},scope:"row",width:"11%",children:p?l:u}),Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},width:"28%",children:m}),Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},list:t,hasLabel:!0,isFetched:n,widthWatcher:function(e){return d((function(t){return Object(g.a)(Object(g.a)({},t),{},Object(O.a)({},i,{count:e}))}))},width:"28%",children:Object(j.jsx)(w,{limited:(null===(r=s[i])||void 0===r?void 0:r.count)>0,limitedLength:null===(o=s[i])||void 0===o?void 0:o.count,selectedList:b.map((function(e){return{name:p?e.role_name_ch:e.role_name_en,id:e.id}}))})}),Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},width:"11%",children:p?h:f}),Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},width:"11%",children:x}),Object(j.jsx)(c.a.BodyCell,{onClick:function(){return a(i)},width:"11%",children:v.slice(0,10)})]},i)})):L})},N=n(388),I=n(361),A=n(620),R=n(386),P=n(597),T=n(611),B=Object(C.a)((function(){return{item:{width:"100%",opacity:"0.5",marginRight:0},itemChecked:{width:"100%",opacity:1,marginRight:0}}})),F=function(e){var t=e.items,n=e.onChange,a=e.selectedvalue,r=B();return Object(j.jsx)(j.Fragment,{children:t.map((function(e){var t=Boolean(a.find((function(t){return t.id===e.id})));return Object(j.jsx)(P.a,{className:t?r.itemChecked:r.item,control:Object(j.jsx)(T.a,{onChange:function(){return n(e)},checked:t}),label:e.name},e.id)}))})},M=n(180),k=n.n(M),G=(n(391),n(412)),H=n.n(G),z=n(387),W=n(55),V=function(e,t,n){var a=Object(R.c)({defaultValues:{itemList:[]}}),r=a.control,o=a.handleSubmit,i=a.getValues,c=a.setValue,l=(0,a.watch)("itemList"),s=function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e.id!==t.id}))};return{control:r,handleSubmit:o,onLabelClick:function(e){var t=i().itemList,n=s(t,e);c("itemList",n)},handleCheck:function(e){var t=i().itemList;return Boolean(t.find((function(t){return t.id===e.id})))?s(t,e):[].concat(Object(N.a)(null!==t&&void 0!==t?t:[]),[e])},hasSelectItem:!Object(W.isEmpty)(l),selectedList:l,setValue:c,onInputClick:function(){e({type:"INPUT_CLICK"}),c("itemList",t.context.submittedList)},onSubmit:function(t){var a=t.itemList.map((function(e){return e.id}));n(a),e({type:"SET_SUBMITTED_LIST",submittedList:t.itemList})}}},U=n(605),K=n(614),Z=n(409),q=Object(K.a)({initial:"close",context:{submittedList:[]},states:{close:{on:{INPUT_CLICK:"expanded"}},expanded:{on:{SET_SUBMITTED_LIST:{target:"close",actions:"saveSubmittedList"},INPUT_CLICK:"close"}}}},{actions:{saveSubmittedList:Object(Z.b)({submittedList:function(e,t){return t.submittedList}})}}),Q=Object(C.a)((function(e){return{form:{position:"relative"},input:{display:"flex",cursor:"pointer",justifyContent:"space-between",background:"#fff",padding:"7px 17px",border:"1px solid #D9DADB",boxSizing:"border-box",borderRadius:"8px"},labelContainer:{display:"flex",alignItems:"center"},arrow:function(e){return{color:"#A1B1CA",transform:e.expended?"rotate(180deg)":"rotate(0deg)",fontSize:"25px"}},popup:function(e){return{position:"absolute",top:"52px",maxWidth:"250px",boxShadow:"0px 4px 16px rgba(38, 100, 223, 0.15)",borderRadius:"8px",background:"#fff",padding:"16px",visibility:e.expended?"visible":"hidden"}},header:{borderBottom:"1px solid #D9DADB",paddingBottom:"16px",marginBottom:"10px"},control:function(t){var n=t.hasSelectItem;return{fontWeight:500,fontSize:e.variables.fontSizeSm,display:"flex",justifyContent:"space-between",paddingBottom:n?"16px":0}},clearButton:{color:e.palette.primary.main},placeholder:{color:"#A6A9AD",fontSize:e.variables.fontSizeSm},content:{maxHeight:"190px"},submitButtonContainer:{paddingTop:"16px"}}})),Y=function(e){var t=e.placeholder,n=e.width,a=e.items,r=e.onSubmit,o=Object(U.b)(q),i=Object(u.a)(o,2),c=i[0],l=i[1],s=V(l,c,r),d=s.control,p=s.handleSubmit,m=s.onLabelClick,b=s.handleCheck,h=s.hasSelectItem,f=s.selectedList,O=s.setValue,g=s.onInputClick,x=s.onSubmit,v=Q({hasSelectItem:h,expended:c.matches("expanded")});return Object(j.jsxs)("form",{className:v.form,onSubmit:p(x),children:[Object(j.jsxs)("div",{onClick:g,className:v.input,style:{width:n},children:[Object(j.jsxs)("div",{className:v.labelContainer,children:[!h&&Object(j.jsx)("span",{className:v.placeholder,children:t}),h&&Object(j.jsx)(w,{hasDeleteIcon:!1,limited:!0,limitedLength:1,selectedList:f,onClick:m})]}),Object(j.jsx)(k.a,{className:v.arrow})]}),Object(j.jsxs)("div",{className:v.popup,children:[Object(j.jsxs)("div",{className:v.header,children:[Object(j.jsxs)("div",{className:v.control,children:[Object(j.jsxs)("div",{children:["\u7be9\u9078\u689d\u4ef6",h&&"(".concat(f.length,")")]}),Object(j.jsx)("button",{className:v.clearButton,type:"button",onClick:function(){return O("itemList",[])},children:"\u6e05\u9664\u5168\u90e8"})]}),h&&Object(j.jsx)(w,{selectedList:f,onClick:m})]}),Object(j.jsx)(H.a,{children:Object(j.jsx)("div",{className:v.content,children:Object(j.jsx)(R.a,{name:"itemList",render:function(e){return Object(j.jsx)(F,{items:a,onChange:function(t){return e.onChange(b(t))},selectedvalue:e.value})},control:d})})}),Object(j.jsx)("div",{className:v.submitButtonContainer,children:Object(j.jsx)(z.a,{type:"submit",height:40,children:"\u78ba\u5b9a"})})]})]})};Y.defaultProps={width:250};var J,X=Y,$=n(416),ee=n(461),te=function(e){var t=e.searchKeyword,n=e.changeOpenFlag,a=e.deptList,r=e.roleList,o=e.changeDepts,i=e.changeRoles,c=window.localStorage.getItem("roleKeywords"),l="zh-TW"===window.localStorage.getItem("language"),s=r.map((function(e){return{id:e.id,name:l?e.role_name_ch:e.role_name_en}})),d=a.map((function(e){return{id:e.id,name:l?e.dept_name_ch:e.dept_name_en}})),u=a.flatMap((function(e){return e.sub_dept})).map((function(e){return{id:e.id,name:l?e.dept_name_ch:e.dept_name_en}})),p=[].concat(Object(N.a)(d),Object(N.a)(u)),m=[];c&&(m=JSON.parse(c));return Object(j.jsxs)(I.a,{display:"flex",justifyContent:"space-between",children:[Object(j.jsx)(ee.a,{placeholder:"\u641c\u5c0b\u89d2\u8272\u59d3\u540d",onSubmit:function(e){t(e)},options:m}),Object(j.jsxs)(I.a,{display:"grid",gridTemplateColumns:"1fr 1fr 122px",gridGap:"16px",children:[Object(j.jsx)(X,{onSubmit:i,items:s,placeholder:"\u5168\u90e8\u89d2\u8272"}),Object(j.jsx)(X,{onSubmit:o,items:p,placeholder:"\u5168\u90e8\u90e8\u9580"}),Object(j.jsxs)($.a,{defaultValue:"all",placeholder:"\u5e33\u865f\u72c0\u614b",onChange:function(e){n(e.target.value)},children:[Object(j.jsx)(A.a,{value:"all",children:"\u5168\u90e8"}),Object(j.jsx)(A.a,{value:"1",children:"\u555f\u7528"}),Object(j.jsx)(A.a,{value:"0",children:"\u505c\u7528"})]})]})]})},ne=n(580),ae=n(458),re=n(39),oe=function(e){var t=e.openDrawer,n=re.a.getPermissions("role:add");return Object(j.jsxs)(I.a,{display:"flex",justifyContent:"space-between",marginBottom:"20px",color:"#153C7B",children:[Object(j.jsx)(ne.a,{variant:"h3",children:"\u5e33\u865f\u5217\u8868"}),n&&Object(j.jsx)(z.a,{width:85,height:40,onClick:t,fullWidth:!1,type:"button",startIcon:Object(j.jsx)("img",{src:ae.a,alt:""}),children:"\u65b0\u589e"})]})},ie=n(7);!function(e){e.OPEN_CREATOR="OPEN_CREATOR",e.OPEN_EDITOR="OPEN_EDITOR",e.CLOSE_DRAWER="CLOSE_DRAWER",e.PAGE_CHANGE="PAGE_CHANGE",e.ORDER_CHANGE="ORDER_CHANGE",e.KEYWORD_CHANGE="KEYWORD_CHANGE",e.ROLES_CHANGE="ROLES_CHANGE",e.DEPTS_CHANGE="DEPTS_CHANGE",e.OPEN_FLAG_CHANGE="OPEN_FLAG_CHANGE",e.OPEN_TOAST="OPEN_TOAST",e.CLOSE_TOAST="CLOSE_TOAST"}(J||(J={}));var ce,le={changePage:Object(Z.b)({currentPage:function(e,t){return t.page}}),changeKeyword:Object(Z.b)({user_name:function(e,t){return t.user_name}}),changeOrder:Object(Z.b)({order:function(e,t){return t.order}}),changeRoles:Object(Z.b)({roles:function(e,t){return t.roles}}),changeDepts:Object(Z.b)({depts:function(e,t){return t.depts}}),changeOpenFlag:Object(Z.b)({open_flag:function(e,t){return t.open_flag}}),openCreator:function(e,t){t.history.push("/pages/usermanagement/account/create")},openEditor:function(e,t){t.id&&t.history.push("/pages/usermanagement/account/edit/".concat(t.id))},closeDrawer:function(e,t){t.history.push("/pages/usermanagement/account")},openToast:Object(Z.b)({toastMessage:function(e,t){return t.message}})},se=Object(K.a)({context:{currentPage:1,user_name:"",order:"-user_name_ch",toastMessage:"",roles:[],depts:[],open_flag:"all"},initial:"viewMode",states:{viewMode:{on:(ce={},Object(O.a)(ce,J.OPEN_CREATOR,{target:"creatorOpened",actions:le.openCreator}),Object(O.a)(ce,J.OPEN_EDITOR,{target:"editorOpened",actions:le.openEditor}),Object(O.a)(ce,J.PAGE_CHANGE,{actions:le.changePage}),Object(O.a)(ce,J.KEYWORD_CHANGE,{actions:le.changeKeyword}),Object(O.a)(ce,J.ORDER_CHANGE,{actions:le.changeOrder}),Object(O.a)(ce,J.ROLES_CHANGE,{actions:le.changeRoles}),Object(O.a)(ce,J.DEPTS_CHANGE,{actions:le.changeDepts}),Object(O.a)(ce,J.OPEN_FLAG_CHANGE,{actions:le.changeOpenFlag}),Object(O.a)(ce,J.OPEN_TOAST,{target:"toastOpened",actions:le.openToast}),ce)},creatorOpened:{on:Object(O.a)({},J.CLOSE_DRAWER,{target:"viewMode",actions:le.closeDrawer})},editorOpened:{on:Object(O.a)({},J.CLOSE_DRAWER,{target:"viewMode",actions:le.closeDrawer})},toastOpened:{on:Object(O.a)({},J.CLOSE_TOAST,"viewMode")}}}),de=n(465),ue=function(e){var t=e.totalPage,n=e.currentPage,a=e.changePage;return Object(j.jsx)(de.a,{shape:"rounded",count:t,page:n,onChange:function(e,t){a(t)}})},pe=n(105),me=n(414),be=n(390),he=n(394);function je(e){return Object(d.a)({config:{url:"account/user",method:"get",params:p(e)},name:s.a.account})}var fe=n(403),Oe=/^[\u4e00-\u9fa5]*$/g,ge=/^[a-z A-Z]*$/g,xe=function(e,t){var n=be.e().required("\u6b64\u70ba\u5fc5\u586b\u6b04\u4f4d").test("checkNameUnique","\u5e33\u865f\u540d\u7a31\u5df2\u91cd\u8907",(function(e){return je({user_name:e}).then((function(e){return 0===e.data.result_data.length}))})),a=fe.a.test("checkNameUnique","\u4fe1\u7bb1\u540d\u7a31\u5df2\u91cd\u8907",(function(e){return je({page:1}).then((function(t){return t.data.result_data.every((function(t){return t.email!==e}))}))})),r=be.d().shape({user_name_ch:n.matches(Oe,"\u8acb\u8f38\u5165\u4e2d\u6587"),user_name_en:n.matches(ge,"\u8acb\u8f38\u5165\u82f1\u6587"),mainDeptId:be.c().required("\u8acb\u9078\u64c7\u4e3b\u90e8\u9580"),email:a,roles:be.a().transform((function(e){return e.filter((function(e){return 0===e||e}))})).min(1,"\u8acb\u81f3\u5c11\u9078\u4e00\u500b\u89d2\u8272")}),o=Object(R.c)({resolver:Object(he.a)(r),defaultValues:{mainDeptId:null,sub_deptId:null,email:"",roles:[],user_name_ch:"",user_name_en:""}}),i=o.control,c=o.handleSubmit,l=o.getValues;return{control:i,handleSubmit:c,handleCheck:function(e){var t=l().roles;return[].concat(Object(N.a)(null!==t&&void 0!==t?t:[]),[e])},removeItem:function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e!==t}))},setValue:o.setValue,onSubmit:function(n){e({dept_id:n.sub_deptId?n.sub_deptId:n.mainDeptId,email:n.email,roles:n.roles,user_name_ch:n.user_name_ch,user_name_en:n.user_name_en}),t()},errors:o.errors,register:o.register}},ve=r.a.createContext(null),_e=n(177),Ce=n(616);function Ee(e){return Object(d.a)({config:{url:"account/user",method:"post",data:e},name:s.a.createAccount})}var Se=n(581),we=n(401),ye=n(393),Le=n(613),De=n(607),Ne=Object(C.a)((function(e){return{listBox:{overflow:"visible",margin:0,padding:0,maxHeight:"210px",boxShadow:"0px 4px 16px rgba(38, 100, 223, 0.15)",fontSize:e.variables.fontSizeSm}}})),Ie=r.a.forwardRef((function(e,t){var n=Ne();return Object(j.jsx)(H.a,{children:Object(j.jsx)("ul",Object(g.a)(Object(g.a)({},e),{},{className:n.listBox,ref:t}))})}));Ie.displayName="listBox";var Ae,Re,Pe=Ie,Te=function(e){var t=e.options,n=e.placeholder,a=e.onChange,r=Object(pe.a)(e,["options","placeholder","onChange"]);return Object(j.jsx)(De.a,Object(g.a)(Object(g.a)({},r),{},{multiple:!0,onChange:function(e,t){a(t.map((function(e){return e.id})))},popupIcon:Object(j.jsx)(j.Fragment,{}),options:t,getOptionLabel:function(e){return e.name},filterSelectedOptions:!0,ListboxComponent:Pe,renderInput:function(e){return Object(j.jsx)(Le.a,Object(g.a)(Object(g.a)({},e),{},{variant:"outlined",placeholder:n}))}}))},Be=Object(C.a)((function(e){return{settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"}}})),Fe=function(e){var t=e.deptList,n=Be(),a=window.localStorage.getItem("language"),o=r.a.useState(null),i=Object(u.a)(o,2),c=i[0],l=i[1],s=r.a.useState(null),d=Object(u.a)(s,2),p=d[0],m=d[1],b=r.a.useContext(ve);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(Se.a,{className:"".concat(n.label," ").concat(n.settingLabel),children:"\u90e8\u9580"}),Object(j.jsxs)(I.a,{display:"grid",gridTemplateColumns:(null===c||void 0===c?void 0:c.sub_dept)?"1fr 1fr":"1fr",gridColumnGap:(null===c||void 0===c?void 0:c.sub_dept)?"16px":"0",children:[Object(j.jsx)(R.a,{name:"mainDeptId",render:function(e){return Object(j.jsx)($.a,{value:c?c.id:"",placeholder:"\u9078\u64c7\u4e3b\u90e8\u9580",defaultValue:"",onChange:function(n){return function(e,n){var a=t.find((function(t){return t.id===e}));m(null),l(a||null),n.onChange(e)}(n.target.value,e)},children:t.map((function(e){return Object(j.jsx)(A.a,{value:e.id,children:a?e.dept_name_ch:e.dept_name_en},e.id)}))})},control:null===b||void 0===b?void 0:b.control}),(null===c||void 0===c?void 0:c.sub_dept)&&Object(j.jsx)(R.a,{name:"sub_deptId",render:function(e){return Object(j.jsx)($.a,{value:p?p.id:"",placeholder:"\u9078\u64c7\u5b50\u90e8\u9580",onChange:function(t){return function(e,t){var n=null===c||void 0===c?void 0:c.sub_dept.find((function(t){return t.id===e}));m(n||null),t.onChange(e)}(t.target.value,e)},children:c.sub_dept.map((function(e){return Object(j.jsx)(A.a,{value:e.id,children:a?e.dept_name_ch:e.dept_name_en},e.id)}))})},control:null===b||void 0===b?void 0:b.control})]})]})},Me=Object(C.a)((function(e){return{roleName:{display:"grid",gridTemplateColumns:"1fr 1fr",gridColumnGap:"16px",marginBottom:"20px"},settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"},errorMessage:{display:"inline-flex",alignItems:"center",color:"#ff1744",marginLeft:"10px",fontSize:e.variables.fontSizeXs,"& .MuiSvgIcon-root":{color:"#ff1744"}},radioGroup:{flexDirection:"row",marginBottom:"12px"}}})),ke=function(e){var t,n,a,o,i,c,l=e.roleList,s=e.deptList,d=Me(),u=window.localStorage.getItem("language"),p=r.a.useContext(ve),m=l.map((function(e){return{id:e.id,name:u?e.role_name_ch:e.role_name_en}}));return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(I.a,{className:d.roleName,children:[Object(j.jsx)(ye.a,{name:"user_name_ch",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u4e2d\u6587\u4f7f\u7528\u8005\u540d\u7a31",height:40,label:"\u59d3\u540d",labelClassName:d.label,error:Boolean(null===p||void 0===p?void 0:p.errors.user_name_ch),errorMessage:null===p||void 0===p||null===(t=p.errors)||void 0===t||null===(n=t.user_name_ch)||void 0===n?void 0:n.message}),Object(j.jsx)(ye.a,{name:"user_name_en",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u82f1\u6587\u4f7f\u7528\u8005\u540d\u7a31",height:40,error:Boolean(null===p||void 0===p?void 0:p.errors.user_name_en),errorMessage:null===p||void 0===p||null===(a=p.errors)||void 0===a||null===(o=a.user_name_en)||void 0===o?void 0:o.message})]}),Object(j.jsx)(I.a,{display:"flex",flexDirection:"column",marginBottom:"20px",children:Object(j.jsx)(ye.a,{name:"email",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u96fb\u5b50\u90f5\u4ef6\u5730\u5740",height:40,label:"\u96fb\u5b50\u90f5\u4ef6\u5730\u5740",labelClassName:d.label,error:Boolean(null===p||void 0===p?void 0:p.errors.email),errorMessage:null===p||void 0===p||null===(i=p.errors)||void 0===i||null===(c=i.email)||void 0===c?void 0:c.message})}),Object(j.jsxs)(Se.a,{className:"".concat(d.label," ").concat(d.settingLabel),children:["\u89d2\u8272",(null===p||void 0===p?void 0:p.errors.roles)&&Object(j.jsx)(we.a,{className:d.errorMessage,message:"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u89d2\u8272"})]}),Object(j.jsx)(I.a,{display:"flex",flexDirection:"column",marginBottom:"20px",children:Object(j.jsx)(R.a,{name:"roles",render:function(e){return Object(j.jsx)(Te,{options:m,onChange:function(t){return e.onChange(t)},placeholder:e.value.length>0?"":"\u8acb\u9078\u64c7\u89d2\u8272 (\u53ef\u8907\u9078)"})},control:null===p||void 0===p?void 0:p.control})}),Object(j.jsx)(Fe,{deptList:s})]})},Ge=Object(C.a)((function(){return{saveButton:{marginLeft:"15px"},deleteButton:{borderColor:"#F66363",color:"#F66363"}}})),He=function(e){var t=e.closeDrawer,n=e.openToast,a=e.deptList,r=e.roleList,o=function(e){var t=Object(_e.b)();return Object(Ce.a)(Ee,{onSuccess:function(){e("\u5df2\u6210\u529f\u65b0\u589e\u4e00\u7b46\u5e33\u865f"),t.invalidateQueries(s.a.account)}})}(n).mutate,i=Ge(),c=xe(o,t),l=c.handleSubmit,d=c.onSubmit,u=Object(pe.a)(c,["handleSubmit","onSubmit"]);return Object(j.jsx)(ve.Provider,{value:u,children:Object(j.jsx)(me.a.Container,{title:"\u65b0\u589e\u5e33\u865f",open:!0,onClose:t,children:Object(j.jsxs)("form",{onSubmit:l(d),children:[Object(j.jsx)(me.a.Content,{children:Object(j.jsx)(ke,{deptList:a,roleList:r})}),Object(j.jsx)(me.a.Footer,{children:Object(j.jsx)(I.a,{display:"flex",justifyContent:"flex-end",children:Object(j.jsxs)(I.a,{children:[Object(j.jsx)(z.a,{onClick:t,width:113,height:40,isWhiteButton:!0,fullWidth:!1,type:"button",children:"\u53d6\u6d88"}),Object(j.jsx)(z.a,{className:i.saveButton,width:113,height:40,fullWidth:!1,type:"submit",children:"\u65b0\u589e"})]})})})]})})})},ze=Object(C.a)((function(){return{saveButton:{marginLeft:"15px"},deleteButton:{borderColor:"#F66363",color:"#F66363"}}})),We=function(e,t,n,a,o){var i=be.d().shape({user_name_ch:be.e().matches(Oe,"\u8acb\u8f38\u5165\u4e2d\u6587").required("\u8acb\u9078\u64c7\u4f7f\u7528\u8005"),user_name_en:be.e().required("\u8acb\u9078\u64c7\u4f7f\u7528\u8005").matches(ge,"\u8acb\u8f38\u5165\u82f1\u6587"),mainDeptId:be.c().required("\u8acb\u9078\u64c7\u4e3b\u90e8\u9580"),email:fe.a,roles:be.a().transform((function(e){return e.filter((function(e){return 0===e||e}))})).min(1,"\u8acb\u81f3\u5c11\u9078\u4e00\u500b\u89d2\u8272")}),c=Object(R.c)({resolver:Object(he.a)(i),defaultValues:{mainDeptId:null,sub_deptId:10,email:"",roles:[],user_name_ch:"",user_name_en:"",openFlag:"0"}}),l=c.control,s=c.handleSubmit,d=c.getValues,u=c.formState,p=c.setValue,m=c.errors,b=c.register,h=c.watch,j=h("mainDeptId"),f=h("sub_deptId"),O=h("roles"),g=h("openFlag"),x=m;return r.a.useLayoutEffect((function(){if(a&&o){var e=a.roles.map((function(e){return e.id})),t=a.dept.sub_dept;p("mainDeptId",Number(a.dept.id)),p("email",a.email),p("roles",e),p("user_name_ch",a.user_name_ch),p("user_name_en",a.user_name_en),p("openFlag",a.open_flag),t&&p("sub_deptId",null===t||void 0===t?void 0:t.id)}}),[o,a,l]),{control:l,isFormDirty:u.isDirty,handleSubmit:s,handleCheck:function(e){var t=d().roles;return[].concat(Object(N.a)(null!==t&&void 0!==t?t:[]),[e])},removeItem:function(e,t){return null===e||void 0===e?void 0:e.filter((function(e){return e!==t}))},setValue:p,onSubmit:function(a){var r=a.openFlag,o=!r;e({id:n,updateData:{dept_id:a.sub_deptId?a.sub_deptId:a.mainDeptId,roles:a.roles,user_name_ch:a.user_name_ch,user_name_en:a.user_name_en,open_flag:o?"2":r}}),t()},errors:x,register:b,watchedMainDeptId:j,watchedSubDeptId:f,watchedRoles:O,watchedOpenFlag:g}},Ve=r.a.createContext(null),Ue=Object(C.a)((function(e){return{settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"}}})),Ke=function(e){var t=e.deptList,n=Ue(),a=window.localStorage.getItem("language"),o=r.a.useContext(Ve),i=function(e){var t=r.a.useContext(Ve),n=r.a.useState(null),a=Object(u.a)(n,2),o=a[0],i=a[1],c=r.a.useState(null),l=Object(u.a)(c,2),s=l[0],d=l[1],p=function(e,t){return e.find((function(e){return e.id===t}))||null};return r.a.useEffect((function(){var n=null===t||void 0===t?void 0:t.watchedMainDeptId,a=null===t||void 0===t?void 0:t.watchedSubDeptId;if(n&&a){var r=p(e,n),o=p(r.sub_dept,a);i(r),d(o)}n&&!a&&i(p(e,n))}),[null===t||void 0===t?void 0:t.watchedMainDeptId,null===t||void 0===t?void 0:t.watchedSubDeptId]),{onMainDeptsChange:function(t,n){var a=p(e,t);d(null),i(a||null),n.onChange(t)},onSubDeptsChange:function(e,t){if(null===o||void 0===o?void 0:o.sub_dept){var n=p(null===o||void 0===o?void 0:o.sub_dept,e);d(n||null),t.onChange(e)}},mainDept:o,sub_dept:s}}(t),c=i.onMainDeptsChange,l=i.onSubDeptsChange,s=i.mainDept,d=i.sub_dept;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(Se.a,{className:"".concat(n.label," ").concat(n.settingLabel),children:"\u90e8\u9580"}),Object(j.jsxs)(I.a,{display:"grid",gridTemplateColumns:(null===s||void 0===s?void 0:s.sub_dept)?"1fr 1fr":"1fr",gridColumnGap:(null===s||void 0===s?void 0:s.sub_dept)?"16px":"0",marginBottom:"20px",children:[Object(j.jsx)(R.a,{name:"mainDeptId",render:function(e){return Object(j.jsx)($.a,{value:s?s.id:"",placeholder:"\u9078\u64c7\u4e3b\u90e8\u9580",defaultValue:"",onChange:function(t){return c(t.target.value,e)},children:t.map((function(e){return Object(j.jsx)(A.a,{value:e.id,children:a?e.dept_name_ch:e.dept_name_en},e.id)}))})},control:null===o||void 0===o?void 0:o.control}),(null===s||void 0===s?void 0:s.sub_dept)&&Object(j.jsx)(R.a,{name:"sub_deptId",render:function(e){return Object(j.jsx)($.a,{value:d?d.id:"",placeholder:"\u9078\u64c7\u5b50\u90e8\u9580",onChange:function(t){return l(t.target.value,e)},children:s.sub_dept.map((function(e){return Object(j.jsx)(A.a,{value:e.id,children:a?e.dept_name_ch:e.dept_name_en},e.id)}))})},control:null===o||void 0===o?void 0:o.control})]})]})},Ze=n(599),qe=Object(C.a)((function(){return{switch:{margin:0,height:"40px",border:"1px solid #D9DADB",width:"100%",borderRadius:"8px",display:"flex",justifyContent:"space-between",padding:"0 10px"}}})),Qe=function(e){var t=e.label,n=e.checked,a=e.onChange,r=Object(pe.a)(e,["label","checked","onChange"]),o=qe();return Object(j.jsx)(P.a,Object(g.a)(Object(g.a)({labelPlacement:"start",onChange:a},r),{},{className:o.switch,control:Object(j.jsx)(Ze.a,{checked:n}),label:t}))};function Ye(){return(Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Je(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Xe(e,t){var n=e.title,r=e.titleId,o=Je(e,["title","titleId"]);return a.createElement("svg",Ye({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,Ae||(Ae=a.createElement("g",{clipPath:"url(#clip0)"},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.3335 5.58838C1.3335 3.93152 2.67664 2.58838 4.3335 2.58838H10.5022C12.159 2.58838 13.5022 3.93152 13.5022 5.58838V8.44443C13.1099 8.278 12.6767 8.18568 12.2213 8.18568C10.4527 8.18568 9.01897 9.5779 9.01897 11.2953C9.01897 11.7376 9.11405 12.1583 9.28544 12.5392H4.3335C2.67664 12.5392 1.3335 11.196 1.3335 9.53918V5.58838ZM3.37736 4.71023C3.58541 4.43245 3.98596 4.37103 4.27202 4.57306L7.41784 6.79472L10.5637 4.57306C10.8497 4.37103 11.2503 4.43245 11.4583 4.71023C11.6664 4.98802 11.6031 5.37698 11.317 5.57901L7.79454 8.0667C7.56996 8.22531 7.26571 8.22531 7.04114 8.0667L3.51863 5.57901C3.23256 5.37698 3.16932 4.98802 3.37736 4.71023Z",fill:"#2664DF"}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2558 12.0259C14.6335 11.6378 14.6335 11.0195 14.2558 10.6313L13.7689 10.1309C13.1431 9.48754 12.0522 9.93064 12.0522 10.8282L12.0522 10.8399L10.7508 10.8399C10.4073 10.8399 10.1288 11.1183 10.1288 11.4618C10.1288 11.8053 10.4073 12.0837 10.7508 12.0837L12.0687 12.0837C12.0736 12.0837 12.0784 12.0836 12.0832 12.0835C12.2653 12.8042 13.2055 13.1055 13.7689 12.5264L14.2558 12.0259Z",fill:"#2664DF"}))),Re||(Re=a.createElement("defs",null,a.createElement("clipPath",{id:"clip0"},a.createElement("rect",{width:16,height:16,fill:"white"})))))}var $e,et,tt=a.forwardRef(Xe);n.p;function nt(){return(nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function at(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rt(e,t){var n=e.title,r=e.titleId,o=at(e,["title","titleId"]);return a.createElement("svg",nt({width:18,height:18,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,$e||($e=a.createElement("g",{clipPath:"url(#clip0)"},a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.7525 1.5H12.255C14.7975 1.5 16.5 3.285 16.5 5.94V12.0675C16.5 14.715 14.7975 16.5 12.255 16.5H5.7525C3.21 16.5 1.5 14.715 1.5 12.0675V5.94C1.5 3.285 3.21 1.5 5.7525 1.5ZM8.99038 6.75011C8.37628 6.75011 7.875 6.24483 7.875 5.62511C7.875 5.0054 8.38141 4.50011 9.0032 4.50011C9.62244 4.50011 10.125 5.0054 10.125 5.62511C10.125 6.24483 9.62244 6.75011 8.99038 6.75011ZM8.0625 9.18761C8.0625 8.66985 8.48223 8.25011 9 8.25011C9.51777 8.25011 9.9375 8.66985 9.9375 9.18761V12.5626C9.9375 13.0804 9.51777 13.5001 9 13.5001C8.48223 13.5001 8.0625 13.0804 8.0625 12.5626V9.18761Z",fill:"#A1B1CA"}))),et||(et=a.createElement("defs",null,a.createElement("clipPath",{id:"clip0"},a.createElement("rect",{width:18,height:18,fill:"white"})))))}var ot=a.forwardRef(rt),it=(n.p,Object(C.a)((function(e){return{settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"},accountInfo:{display:"flex",alignItems:"center",paddingTop:"8px",fontSize:e.variables.fontSizeXs},accountInfoText:{paddingLeft:"6px"}}}))),ct=function(){var e=it(),t=r.a.useContext(Ve),n="2"===(null===t||void 0===t?void 0:t.openFlag),a="1"===(null===t||void 0===t?void 0:t.watchedOpenFlag);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(Se.a,{className:"".concat(e.label," ").concat(e.settingLabel),children:"\u5e33\u865f\u72c0\u614b"}),n?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(z.a,{onClick:function(){(null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t||t.sendEmail({email:t.email}))},startIcon:Object(j.jsx)(tt,{}),width:170,height:40,type:"button",isWhiteButton:!0,children:"\u5bc4\u9001\u5e33\u865f\u958b\u901a\u4fe1"}),Object(j.jsxs)(Se.a,{className:e.accountInfo,children:[Object(j.jsx)(ot,{}),Object(j.jsx)("span",{className:e.accountInfoText,children:"\u6b64\u4eba\u54e1\u7684\u5e33\u865f\u5c1a\u672a\u958b\u901a\uff0c\u7ba1\u7406\u54e1\u53ef\u4ee5\u900f\u904e\u5bc4\u9001\u4fe1\u4ef6\u5e6b\u52a9\u4ed6\u958b\u901a\u5e33\u865f\u3002"})]})]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(R.a,{name:"openFlag",render:function(e){return Object(j.jsx)(Qe,{onChange:function(t,n){return function(e,t){t.onChange(e?"1":"0")}(n,e)},checked:a,label:a?"\u555f\u7528":"\u505c\u7528"})},control:null===t||void 0===t?void 0:t.control}),!a&&Object(j.jsxs)(Se.a,{className:e.accountInfo,children:[Object(j.jsx)(ot,{}),Object(j.jsx)("span",{className:e.accountInfoText,children:"\u5728\u7ba1\u7406\u54e1\u518d\u6b21\u555f\u7528\u6b64\u5e33\u865f\u4e4b\u524d\uff0c\u6b64\u54e1\u5de5\u7684\u5e33\u865f\u5c07\u6703\u5931\u6548\uff0c\u7121\u6cd5\u767b\u5165\u6b64\u7cfb\u7d71\u3002"})]})]})]})},lt=function(e){var t=r.a.useState([]),n=Object(u.a)(t,2),a=n[0],o=n[1],i="zh-TW"===window.localStorage.getItem("language"),c=r.a.useContext(Ve),l=null===c||void 0===c?void 0:c.watchedRoles,s=function(t){var n=e.find((function(e){return e.id===t}));return i?null===n||void 0===n?void 0:n.role_name_ch:null===n||void 0===n?void 0:n.role_name_en};return r.a.useEffect((function(){l&&o(l.map((function(e){return{id:e,name:s(e)}})))}),[l]),{selectedRoleList:a}},st=Object(C.a)((function(e){return{roleName:{display:"grid",gridTemplateColumns:"1fr 1fr",gridColumnGap:"16px",marginBottom:"20px"},settingLabel:{marginBottom:"5px"},label:{fontSize:e.variables.fontSizeSm,color:e.palette.primary.main,fontWeight:500,display:"flex",alignItems:"center"},errorMessage:{display:"inline-flex",alignItems:"center",color:"#ff1744",marginLeft:"10px",fontSize:e.variables.fontSizeXs,"& .MuiSvgIcon-root":{color:"#ff1744"}},radioGroup:{flexDirection:"row",marginBottom:"12px"}}})),dt=function(e){var t,n,a,o,i,c,l=e.roleList,s=e.deptList,d=st(),u=window.localStorage.getItem("language"),p=r.a.useContext(Ve),m=l.map((function(e){return{id:e.id,name:u?e.role_name_ch:e.role_name_en}})),b=lt(l).selectedRoleList;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(I.a,{className:d.roleName,children:[Object(j.jsx)(ye.a,{name:"user_name_ch",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u4e2d\u6587\u4f7f\u7528\u8005\u540d\u7a31",height:40,label:"\u59d3\u540d",labelClassName:d.label,error:Boolean(null===p||void 0===p?void 0:p.errors.user_name_ch),errorMessage:null===p||void 0===p||null===(t=p.errors)||void 0===t||null===(n=t.user_name_ch)||void 0===n?void 0:n.message}),Object(j.jsx)(ye.a,{name:"user_name_en",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u82f1\u6587\u4f7f\u7528\u8005\u540d\u7a31",height:40,error:Boolean(null===p||void 0===p?void 0:p.errors.user_name_en),errorMessage:null===p||void 0===p||null===(a=p.errors)||void 0===a||null===(o=a.user_name_en)||void 0===o?void 0:o.message})]}),Object(j.jsx)(I.a,{display:"flex",flexDirection:"column",marginBottom:"20px",children:Object(j.jsx)(ye.a,{name:"email",ref:null===p||void 0===p?void 0:p.register,placeholder:"\u8acb\u8f38\u5165\u96fb\u5b50\u90f5\u4ef6\u5730\u5740",height:40,label:"\u96fb\u5b50\u90f5\u4ef6\u5730\u5740",labelClassName:d.label,error:Boolean(null===p||void 0===p?void 0:p.errors.email),errorMessage:null===p||void 0===p||null===(i=p.errors)||void 0===i||null===(c=i.email)||void 0===c?void 0:c.message})}),Object(j.jsxs)(Se.a,{className:"".concat(d.label," ").concat(d.settingLabel),children:["\u89d2\u8272",(null===p||void 0===p?void 0:p.errors.roles)&&Object(j.jsx)(we.a,{className:d.errorMessage,message:"\u8acb\u81f3\u5c11\u52fe\u9078\u4e00\u500b\u89d2\u8272"})]}),Object(j.jsx)(I.a,{display:"flex",flexDirection:"column",marginBottom:"20px",children:Object(j.jsx)(R.a,{name:"roles",render:function(e){return Object(j.jsx)(Te,{value:b,options:m,onChange:function(t){return e.onChange(t)},placeholder:e.value.length>0?"":"\u8acb\u9078\u64c7\u89d2\u8272 (\u53ef\u8907\u9078)"})},control:null===p||void 0===p?void 0:p.control})}),Object(j.jsx)(Ke,{deptList:s}),Object(j.jsx)(ct,{})]})};function ut(e){var t=Object(_e.b)(),n=Object(l.a)([s.a.accountInfo,e],(function(){return t={id:e},Object(d.a)({config:{url:"".concat("account/user","/").concat(t.id),method:"get"},name:s.a.accountInfo});var t}),{refetchOnWindowFocus:!1,refetchOnMount:!1,retry:!1}),a=n.data,o=n.isFetched;return r.a.useEffect((function(){t.invalidateQueries(s.a.accountInfo)}),[e]),{accountInfo:null===a||void 0===a?void 0:a.data.result_data,isAccountInfoFetched:o}}function pt(e){return Object(d.a)({config:{url:"".concat("account/user","/").concat(e.id),method:"patch",data:e.updateData},name:s.a.updateAccount})}var mt,bt=n(466);!function(e){e.OPEN_ALERT="OPEN_ALERT",e.CLOSE_ALERT="CLOSE_ALERT"}(mt||(mt={}));var ht={openAlert:Object(Z.b)({alertMessage:function(e,t){return t.message}})},jt=Object(K.a)({context:{alertMessage:{title:"",content:"",isDicidedMode:!1},hasQueryPermission:!1,hasUpdatePermission:!1},initial:"alertClosed",states:{alertClosed:{on:Object(O.a)({},mt.OPEN_ALERT,{target:"alertOpened",actions:ht.openAlert})},alertOpened:{on:Object(O.a)({},mt.CLOSE_ALERT,"alertClosed")}}});function ft(e){return Object(d.a)({config:{url:"account/auth/account_open",method:"get",params:e},name:s.a.sendOpenAccountEmail})}var Ot=function(e){var t=e.closeDrawer,n=e.openToast,a=e.deptList,r=e.roleList,o=Object(ie.i)(),i=function(e){var t=Object(_e.b)();return Object(Ce.a)(pt,{onSuccess:function(){e("\u5df2\u6210\u529f\u66f4\u65b0\u5e33\u865f"),t.invalidateQueries(s.a.account)}})}(n).mutate,c=ze(),l=function(){var e=re.a.getPermissions("user:qry"),t=re.a.getPermissions("user:up"),n=Object(U.b)(jt,{context:{hasQueryPermission:e,hasUpdatePermission:t}}),a=Object(u.a)(n,2),r=a[0],o=a[1],i={openAlert:function(e){o({type:mt.OPEN_ALERT,message:e})},closeAlert:function(){o({type:mt.CLOSE_ALERT})}};return Object(g.a)(Object(g.a)({},i),{},{isAlertOpen:r.matches("alertOpened"),alertMessage:r.context.alertMessage,hasQueryPermission:r.context.hasQueryPermission,hasUpdatePermission:r.context.hasUpdatePermission})}(),d=l.openAlert,p=l.closeAlert,m=l.isAlertOpen,b=l.hasQueryPermission,h=l.hasUpdatePermission,f=l.alertMessage,O=function(e){return Object(Ce.a)(ft,{onSuccess:function(){e({title:"\u5df2\u767c\u9001\u5e33\u865f\u958b\u901a\u4fe1\u7d66\u65b0\u589e\u4eba\u54e1",content:"\u6b64\u65b0\u589e\u4eba\u54e1\u53ef\u65b0\u589e\u4eba\u54e1\u53ef\u900f\u904e\u4fe1\u4e2d\u9023\u7d50\u958b\u901a\u5e33\u865f",isDicidedMode:!1})}})}(d).mutate,x=ut(o.id),v=x.accountInfo,_=x.isAccountInfoFetched,C=We(i,t,Number(o.id),v,_),E=C.handleSubmit,S=C.onSubmit,w=C.isFormDirty,y=Object(pe.a)(C,["handleSubmit","onSubmit","isFormDirty"]),L=function(){w?d({title:"\u78ba\u5b9a\u8981\u6368\u68c4\u7de8\u8f2f\u4e2d\u7684\u5167\u5bb9\u55ce\uff1f",content:"\u82e5\u73fe\u5728\u96e2\u958b\u6b64\u9801\u9762\uff0c\u60a8\u7de8\u8f2f\u7684\u8cc7\u6599\u5c07\u4e0d\u6703\u5132\u5b58",isDicidedMode:!0,onConfirm:t}):t()};return Object(j.jsx)(Ve.Provider,{value:Object(g.a)(Object(g.a)({},y),{},{openFlag:null===v||void 0===v?void 0:v.open_flag,email:null===v||void 0===v?void 0:v.email,hasQueryPermission:b,hasUpdatePermission:h,sendEmail:O}),children:Object(j.jsxs)(me.a.Container,{title:"\u7de8\u8f2f\u5e33\u865f",open:!0,onClose:L,children:[Object(j.jsx)(bt.a,{isDicidedMode:f.isDicidedMode,onConfirm:f.onConfirm,onClose:p,open:m,title:f.title,content:f.content}),Object(j.jsxs)("form",{onSubmit:E(S),children:[Object(j.jsx)(me.a.Content,{children:Object(j.jsx)(dt,{deptList:a,roleList:r})}),h&&Object(j.jsx)(me.a.Footer,{children:Object(j.jsx)(I.a,{display:"flex",justifyContent:"flex-end",children:Object(j.jsxs)(I.a,{children:[Object(j.jsx)(z.a,{onClick:L,width:113,height:40,isWhiteButton:!0,fullWidth:!1,type:"button",children:"\u53d6\u6d88"}),Object(j.jsx)(z.a,{className:c.saveButton,width:113,height:40,fullWidth:!1,type:"submit",children:"\u5132\u5b58"})]})})})]})]})})},gt=function(e){var t=e.closeDrawer,n=e.openToast,o=e.deptList,i=e.roleList,c=Object(ie.h)(),l=re.a.getPermissions("role:add");return r.a.useEffect((function(){var e=c.pathname;!e.includes("create")&&!e.includes("edit")&&t()}),[c]),Object(j.jsx)(a.Suspense,{fallback:Object(j.jsx)(v.a,{}),children:Object(j.jsxs)(ie.d,{children:[l&&Object(j.jsx)(ie.b,{strict:!0,sensitive:!0,exact:!0,path:"/pages/usermanagement/account/create",children:Object(j.jsx)(He,{deptList:o,roleList:i,closeDrawer:t,openToast:n})}),Object(j.jsx)(ie.b,{strict:!0,sensitive:!0,exact:!0,path:"/pages/usermanagement/account/edit/:id",children:Object(j.jsx)(Ot,{deptList:o,roleList:i,closeDrawer:t,openToast:n})}),Object(j.jsx)(ie.a,{exact:!0,from:"/pages/usermanagement/account/*",to:"/pages/usermanagement/account"})]})})},xt=n(463);function vt(){return Object(d.a)({config:{url:"department/list",method:"get"},name:s.a.dept})}t.default=function(){var e=function(){var e=Object(U.b)(se),t=Object(u.a)(e,2),n=t[0],a=t[1],o=Object(ie.g)(),i=Object(ie.h)(),c={openCreator:function(){a({type:J.OPEN_CREATOR,history:o})},closeToast:function(){a({type:J.CLOSE_TOAST})},closeDrawer:function(){a({type:J.CLOSE_DRAWER,history:o})},openEditor:function(e){a({type:J.OPEN_EDITOR,history:o,id:e})},searchKeyword:function(e){a({type:J.KEYWORD_CHANGE,user_name:e})},changePage:function(e){a({type:J.PAGE_CHANGE,page:e})},changeOrder:function(e){a({type:J.ORDER_CHANGE,order:e})},changeRoles:function(e){a({type:J.ROLES_CHANGE,roles:e})},changeDepts:function(e){a({type:J.DEPTS_CHANGE,depts:e})},changeOpenFlag:function(e){a({type:J.OPEN_FLAG_CHANGE,open_flag:e})},openToast:function(e){a({type:J.OPEN_TOAST,message:e})}};return r.a.useEffect((function(){var e=i.pathname.includes("create"),t=i.pathname.includes("edit");e&&c.openCreator(),t&&c.openEditor()}),[i]),Object(g.a)(Object(g.a)({},c),{},{isToastOpen:n.matches("toastOpened"),context:n.context})}(),t=e.openCreator,n=e.openEditor,a=e.openToast,d=e.closeToast,p=e.isToastOpen,b=e.closeDrawer,h=e.changePage,O=e.changeOrder,x=e.changeDepts,v=e.changeRoles,_=e.changeOpenFlag,C=e.searchKeyword,E=e.context,S=m(E),w=S.roleResponse,y=S.isRoleFetched,L=function(){var e=Object(l.a)(s.a.dept,vt,{keepPreviousData:!0});return{deptResponse:e.data,isDeptFetched:e.isFetched}}(),N=L.deptResponse,I=L.isDeptFetched,A=function(e){var t=e.currentPage,n=e.user_name,a=e.order,r=e.roles,o=e.depts,i=e.open_flag,c=Object(l.a)([s.a.account,t,n,a,r.join(),o.join(),i],(function(){return je({page:t,user_name:n,order:a,roles:r.join(),depts:o.join(),open_flag:i})}),{keepPreviousData:!0});return{accountResponse:c.data,isAccountFetched:c.isSuccess}}(E),R=A.accountResponse,P=A.isAccountFetched,T=null===w||void 0===w?void 0:w.data.result_data,B=null===N||void 0===N?void 0:N.data.result_data,F=null===R||void 0===R?void 0:R.data.result_data,M=null===R||void 0===R?void 0:R.data.pagination.total_pages;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(xt.a,{anchorOrigin:{horizontal:"center",vertical:"top"},open:p,onClose:d,message:E.toastMessage,severity:"success"}),Object(j.jsx)(oe,{openDrawer:t}),Object(j.jsxs)(i.a.Container,{children:[Object(j.jsx)(i.a.Control,{children:I&&y&&Object(j.jsx)(te,{roleList:T,deptList:B,changeDepts:x,changeRoles:v,changeOpenFlag:_,searchKeyword:C})}),Object(j.jsx)(i.a.Info,{children:Object(j.jsx)(o.a,{children:Object(j.jsxs)(c.a.Table,{children:[Object(j.jsx)(f,{sortMethod:O}),Object(j.jsx)(D,{openEditor:n,isFetched:P,list:F})]})})})]}),Object(j.jsx)(ue,{totalPage:M,currentPage:E.currentPage,changePage:h}),I&&y&&Object(j.jsx)(gt,{roleList:T,deptList:B,closeDrawer:b,openToast:a})]})}}}]);
//# sourceMappingURL=12.9233f8b0.chunk.js.map